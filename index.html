<!DOCTYPE html>
<html lang="en">
 <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Productivity App</title>
    <link href="styles.css" rel="stylesheet"/>
  </head>
  <body>

    <div class = "title"> <!--Title-->
    <h1>Productivity App</h1>
    </div> 

     <!--The pamadoro clock style-->
    <div class = "Pclock">
      <h1>Pamadora Clock</h1>

      <div class = "time">
        <p>time fn</p>
        <span class = "digit" id = "hr">00</span>
        <span class = "txt">Hr</span>

        <span class = "digit" id ="min">00</span>
        <span class = "txt">Min</span>

        <span class = "digit" id = "sec">00</span>
        <span class = "txt">Sec</span>
      </div>

      <div class = "buttons">
          <button class = "btns" id = "start">Start</button>
          <button class = "btns" id = "stop">Stop</button>
          <button class = "btns" id = "reset">Reset</button>
      </div>

    </div>
  
    <div class = "taskbar" >
      <h3>Tasks</h3>
      <section class = "notes">
        <form id="taskForm">
          <input type="text" id="taskTitle" placeholder="Add Notes">
          <button type="submit">Add Task</button>
        </form>
      </section>
    </div>

    <h2 class = "calender">Calender</h2>

    <script>
  // Function to add a task
  function addTask(title) {
    fetch('http://localhost:8080/tasks/api/add', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ title: title })
    })
    .then(response => {
      if (response.ok) {
        alert('Task added!');
        document.getElementById('taskTitle').value = '';
        loadTasks(); // Refresh task list
      } else {
        alert('Error adding task');
      }
    });
  }

  // Function to get all tasks
  function getAllTasks() {
    return fetch('/tasks/api/tasks')
      .then(response => response.json());
  }

  // Function to display tasks in the taskbar
  function loadTasks() {
    getAllTasks().then(tasks => {
      const taskList = document.querySelector('.notes ul');
      if (!taskList) {
        const ul = document.createElement('ul');
        document.querySelector('.notes').appendChild(ul);
      }
      const ul = document.querySelector('.notes ul');
      ul.innerHTML = '';
      tasks.forEach(task => {
        const li = document.createElement('li');
        li.textContent = task.title;
        ul.appendChild(li);
      });
    });
  }

  // Event listener for form submit
  document.getElementById('taskForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const title = document.getElementById('taskTitle').value;
    if (title.trim() !== '') {
      addTask(title);
    }
  });

  // Load tasks when page loads
  window.addEventListener('DOMContentLoaded', loadTasks);
</script>
  </body>
</html>